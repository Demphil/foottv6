name: Update Matches Data

on:
  schedule:
    - cron: '0 */3 * * *'  # ÙƒÙ„ 3 Ø³Ø§Ø¹Ø§Øª
  workflow_dispatch:

jobs:
  update-matches:
    runs-on: ubuntu-latest
    timeout-minutes: 10

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: Create Matches Data
        run: |
          mkdir -p data
          cat << 'EOF' > data/matches.json
          {
            "today": [
              {
                "id": "match-1",
                "homeTeam": {
                  "name": "Ø§Ù„Ù‡Ù„Ø§Ù„",
                  "logo": "https://kooora.live-kooora.com//logos/alhilal.png"
                },
                "awayTeam": {
                  "name": "Ø§Ù„Ù†ØµØ±", 
                  "logo": "https://kooora.live-kooora.com//logos/alnassr.png"
                },
                "score": "VS",
                "time": "21:00",
                "date": "$(date -u +'%Y-%m-%dT21:00:00Z')",
                "league": {
                  "name": "Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ",
                  "logo": "https://kooora.live-kooora.com//logos/spl.png"
                },
                "channels": ["bein SPORTS HD1"],
                "status": "Ù‚Ø§Ø¯Ù…",
                "isFeatured": true
              }
            ],
            "tomorrow": [],
            "updatedAt": "$(date -u +'%Y-%m-%dT%H:%M:%SZ')"
          }
          EOF

      - name: Verify Data
        run: |
          echo "ğŸ“‚ Ù…Ø­ØªÙˆÙ‰ Ù…Ù„Ù matches.json:"
          cat assets/data/matches.json
          echo ""
          echo "ğŸ”„ Ø¹Ø¯Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…: $(jq '.today | length' assets/data/matches.json)"
          echo "â± ÙˆÙ‚Øª Ø§Ù„ØªØ­Ø¯ÙŠØ«: $(jq -r '.updatedAt' assets/data/matches.json)"

      - name: Commit & Push Changes
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          git add assets/data/matches.json
          git commit -m "ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª [skip ci]" || echo "Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØºÙŠÙŠØ±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©"
          git push
